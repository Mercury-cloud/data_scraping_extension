webpackJsonp([1],{"+LL8":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("3j3K"),i=n("iu7K"),o=n("YtC4"),s=n("YO03"),a=n("2Je8"),u=n("Qbdm"),c=n("NVOs"),f=n("jPRv"),l=n("dyjq"),h=n("UWBK"),d=n("c/bU"),p=n("y3P1"),v=n("/PSk"),m=n("Fzro"),y=n("Tkuz"),g=n("8AXl"),b=n("nfmY"),w=n("Zhbi");e.BgModuleNgFactory=r.\u0275cmf(i.BgModule,[o.AppComponent],function(t){return r.\u0275mod([r.\u0275mpd(512,r.ComponentFactoryResolver,r.\u0275CodegenComponentFactoryResolver,[[8,[s.AppComponentNgFactory]],[3,r.ComponentFactoryResolver],r.NgModuleRef]),r.\u0275mpd(5120,r.LOCALE_ID,r.\u0275m,[[3,r.LOCALE_ID]]),r.\u0275mpd(4608,a.NgLocalization,a.NgLocaleLocalization,[r.LOCALE_ID]),r.\u0275mpd(4608,r.Compiler,r.Compiler,[]),r.\u0275mpd(5120,r.APP_ID,r.\u0275f,[]),r.\u0275mpd(5120,r.IterableDiffers,r.\u0275k,[]),r.\u0275mpd(5120,r.KeyValueDiffers,r.\u0275l,[]),r.\u0275mpd(4608,u.DomSanitizer,u.\u0275e,[a.DOCUMENT]),r.\u0275mpd(6144,r.Sanitizer,null,[u.DomSanitizer]),r.\u0275mpd(4608,u.HAMMER_GESTURE_CONFIG,u.HammerGestureConfig,[]),r.\u0275mpd(5120,u.EVENT_MANAGER_PLUGINS,function(t,e,n,r){return[new u.\u0275DomEventsPlugin(t),new u.\u0275KeyEventsPlugin(e),new u.\u0275HammerGesturesPlugin(n,r)]},[a.DOCUMENT,a.DOCUMENT,a.DOCUMENT,u.HAMMER_GESTURE_CONFIG]),r.\u0275mpd(4608,u.EventManager,u.EventManager,[u.EVENT_MANAGER_PLUGINS,r.NgZone]),r.\u0275mpd(135680,u.\u0275DomSharedStylesHost,u.\u0275DomSharedStylesHost,[a.DOCUMENT]),r.\u0275mpd(4608,u.\u0275DomRendererFactory2,u.\u0275DomRendererFactory2,[u.EventManager,u.\u0275DomSharedStylesHost]),r.\u0275mpd(6144,r.RendererFactory2,null,[u.\u0275DomRendererFactory2]),r.\u0275mpd(6144,u.\u0275SharedStylesHost,null,[u.\u0275DomSharedStylesHost]),r.\u0275mpd(4608,r.Testability,r.Testability,[r.NgZone]),r.\u0275mpd(4608,u.Meta,u.Meta,[a.DOCUMENT]),r.\u0275mpd(4608,u.Title,u.Title,[a.DOCUMENT]),r.\u0275mpd(4608,c.\u0275i,c.\u0275i,[]),r.\u0275mpd(4608,f.ListenerService,f.ListenerService,[l.Store,h.BgStateActions]),r.\u0275mpd(4608,d.ContentCommService,d.ContentCommService,[r.NgZone]),r.\u0275mpd(4608,p.WebsocketService,p.WebsocketService,[l.Store]),r.\u0275mpd(4608,v.CommandsRouter,v.CommandsRouter,[l.Store,p.WebsocketService,h.BgStateActions]),r.\u0275mpd(512,a.CommonModule,a.CommonModule,[]),r.\u0275mpd(512,r.ErrorHandler,i.RavenErrorHandler,[]),r.\u0275mpd(1024,r.APP_INITIALIZER,function(t,e){return[u.\u0275c(t,e)]},[[2,u.NgProbeToken],[2,r.NgProbeToken]]),r.\u0275mpd(512,r.ApplicationInitStatus,r.ApplicationInitStatus,[[2,r.APP_INITIALIZER]]),r.\u0275mpd(131584,r.\u0275e,r.\u0275e,[r.NgZone,r.\u0275Console,r.Injector,r.ErrorHandler,r.ComponentFactoryResolver,r.ApplicationInitStatus]),r.\u0275mpd(2048,r.ApplicationRef,null,[r.\u0275e]),r.\u0275mpd(512,r.ApplicationModule,r.ApplicationModule,[r.ApplicationRef]),r.\u0275mpd(512,u.BrowserModule,u.BrowserModule,[[3,u.BrowserModule]]),r.\u0275mpd(512,c.\u0275ba,c.\u0275ba,[]),r.\u0275mpd(512,c.FormsModule,c.FormsModule,[]),r.\u0275mpd(512,m.HttpModule,m.HttpModule,[]),r.\u0275mpd(131584,l.ActionsSubject,l.ActionsSubject,[]),r.\u0275mpd(2048,l.ReducerManagerDispatcher,null,[l.ActionsSubject]),r.\u0275mpd(256,l._INITIAL_STATE,{bgState:{user:null,counters:null,serverData:null,extension:null,pins:null}},[]),r.\u0275mpd(1024,l.INITIAL_STATE,l._initialStateFactory,[l._INITIAL_STATE]),r.\u0275mpd(256,l._INITIAL_REDUCERS,y.REDUCERS_TOKEN,[]),r.\u0275mpd(2048,l._STORE_REDUCERS,null,[l._INITIAL_REDUCERS]),r.\u0275mpd(1024,l.INITIAL_REDUCERS,l._createStoreReducers,[r.Injector,l._INITIAL_REDUCERS,l._STORE_REDUCERS]),r.\u0275mpd(256,l._REDUCER_FACTORY,l.combineReducers,[]),r.\u0275mpd(256,l.META_REDUCERS,[],[]),r.\u0275mpd(1024,l.REDUCER_FACTORY,l.createReducerFactory,[l._REDUCER_FACTORY,l.META_REDUCERS]),r.\u0275mpd(131584,l.ReducerManager,l.ReducerManager,[l.ReducerManagerDispatcher,l.INITIAL_STATE,l.INITIAL_REDUCERS,l.REDUCER_FACTORY]),r.\u0275mpd(2048,l.ReducerObservable,null,[l.ReducerManager]),r.\u0275mpd(131584,l.ScannedActionsSubject,l.ScannedActionsSubject,[]),r.\u0275mpd(512,l.StoreRootModule,l.StoreRootModule,[l.ActionsSubject,l.ReducerObservable,l.ScannedActionsSubject]),r.\u0275mpd(1024,g.\u0275g,g.\u0275b,[]),r.\u0275mpd(512,g.\u0275h,g.\u0275h,[g.\u0275g]),r.\u0275mpd(512,g.EffectSources,g.EffectSources,[g.\u0275h]),r.\u0275mpd(131584,l.State,l.State,[l.ActionsSubject,l.ReducerObservable,l.ScannedActionsSubject,l.INITIAL_STATE]),r.\u0275mpd(2048,l.StateObservable,null,[l.State]),r.\u0275mpd(512,l.Store,l.Store,[l.StateObservable,l.ActionsSubject,l.ReducerManager]),r.\u0275mpd(131584,g.\u0275i,g.\u0275i,[g.EffectSources,l.Store]),r.\u0275mpd(512,m.BrowserXhr,m.BrowserXhr,[]),r.\u0275mpd(512,m.ResponseOptions,m.BaseResponseOptions,[]),r.\u0275mpd(1024,m.XSRFStrategy,m.\u0275b,[]),r.\u0275mpd(512,m.XHRBackend,m.XHRBackend,[m.BrowserXhr,m.ResponseOptions,m.XSRFStrategy]),r.\u0275mpd(512,m.RequestOptions,m.BaseRequestOptions,[]),r.\u0275mpd(1024,m.Http,m.\u0275c,[m.XHRBackend,m.RequestOptions]),r.\u0275mpd(512,h.BgStateActions,h.BgStateActions,[r.ApplicationRef,l.Store]),r.\u0275mpd(512,b.BgStateService,b.BgStateService,[l.Store,m.Http,h.BgStateActions]),r.\u0275mpd(512,g.Actions,g.Actions,[l.ScannedActionsSubject]),r.\u0275mpd(512,w.BgStateEffects,w.BgStateEffects,[l.Store,b.BgStateService,g.Actions]),r.\u0275mpd(1024,g.\u0275e,g.\u0275a,[w.BgStateEffects]),r.\u0275mpd(512,g.\u0275c,g.\u0275c,[g.EffectSources,g.\u0275i,l.Store,g.\u0275e,[2,l.StoreModule]]),r.\u0275mpd(512,i.BgModule,i.BgModule,[]),r.\u0275mpd(256,y.REDUCERS_TOKEN,y.rootReducer,[])])})},"/L6G":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n("owTz"),n("xgm2"),n("kJrM"),n("cxtG"),n("xInZ"),n("0eak"),n("jNaG"),n("PCB2"),n("VwFy"),n("F3G9"),n("v7CW"),n("o53x"),n("kWGS"),n("cPqY"),n("qYgd"),n("hNco"),n("/+N7"),n("aTdd"),n("PG6h"),n("n6VF"),n("2fw/"),n("bqhO"),n("ZJhL"),n("VKQ6"),n("a7sO"),n("2Gc2"),n("lMWm"),n("apTM"),n("TDKa"),n("u//w"),n("HUv8"),n("2vRS"),n("MQ0p"),n("bAW0"),n("uX89"),n("MDfR"),n("5wxv")},"/PSk":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("IJ8i"),i=n("M4fF"),o=n("ehMW"),s=n("dyjq"),a=n("UWBK"),u=n("y3P1"),c=n("ETHv"),f=function(){function t(t,e,n){var s=this;this._store=t,this._websocketService=e,this._bgStateActions=n,this.et=function(t,e,n){switch(+t.command){case r.Command.sendVote:return s.s.u(r.Command.sendVote,t.payload,{socket:s._websocketService}).c(r.Command.sendVote).subscribe(function(t){try{n(t)}catch(t){}},function(){}),!0;case r.Command.getBGSettings:return n({status:"done",settings:s.bg_settings.iframes[t.payload.host]}),!0;case r.Command.setBGUser:return s._bgStateActions._setUser(t.payload),n({status:"done"}),!0;case r.Command.setBGSettings:return s.bg_settings.iframes=i.merge({},s.bg_settings.iframes,t.payload),n({status:"done"}),!0;case r.Command.removeBGSettings:return delete s.bg_settings.iframes[t.payload.host],n({status:"done"}),!0}return!0},chrome.runtime.onMessage.addListener(this.et),this.s=new o.CommandFactoryBg,this.bg_settings={iframes:{}},this.bg=chrome.extension.getBackgroundPage().dmBackground,this.bg.sendVoteProxy=function(t,e){t.payload.content.data.recipe=c.DmUtility.ol(t.payload.content.data.recipe),s.et(t,{},e)}}return t.ctorParameters=function(){return[{type:s.Store},{type:u.WebsocketService},{type:a.BgStateActions}]},t}();e.CommandsRouter=f},0:function(t,e){},1:function(t,e,n){t.exports=n("kk9o")},2:function(t,e){},3:function(t,e){},"6GLz":function(t,e){function n(t){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+t+"'.")})}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="6GLz"},"9C4N":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DM_GLOBAL={extensio_id:"nndknepjnldbdbepjfgmncbggmopgden",extension_type:"dm-043d7813-a73a-4e9b-be24-e0dcda33fde9"}},"9zHd":function(t,e,n){var r,i,o;i=[],void 0===(o="function"==typeof(r=function(){"use strict";var t,e,n="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof n?n:{},r=!n.document&&!!n.postMessage,i=r&&/(\?|&)papaworker(=|&|$)/.test(n.location.search),o=!1,s={},a=0,u={parse:function(e,r){if((r=r||{}).dynamicTyping=r.dynamicTyping||!1,r.worker&&u.WORKERS_SUPPORTED){var i=function(){if(!u.WORKERS_SUPPORTED)return!1;if(!o&&null===u.SCRIPT_PATH)throw new Error("Script path cannot be determined automatically when Papa Parse is loaded asynchronously. You need to set Papa.SCRIPT_PATH manually.");var e=u.SCRIPT_PATH||t;e+=(-1!==e.indexOf("?")?"&":"?")+"papaworker";var r=new n.Worker(e);return r.onmessage=m,r.id=a++,s[r.id]=r,r}();return i.userStep=r.step,i.userChunk=r.chunk,i.userComplete=r.complete,i.userError=r.error,r.step=_(r.step),r.chunk=_(r.chunk),r.complete=_(r.complete),r.error=_(r.error),delete r.worker,void i.postMessage({input:e,config:r,workerId:i.id})}var c=null;"string"==typeof e?c=r.download?new l(r):new d(r):(n.File&&e instanceof File||e instanceof Object)&&(c=new h(r));return c.stream(e)},unparse:function(t,e){var n=!1,r=!0,i=",",o="\r\n",s='"';!function(){if("object"!=typeof e)return;"string"==typeof e.delimiter&&1===e.delimiter.length&&-1===u.BAD_DELIMITERS.indexOf(e.delimiter)&&(i=e.delimiter);("boolean"==typeof e.quotes||e.quotes instanceof Array)&&(n=e.quotes);"string"==typeof e.newline&&(o=e.newline);"string"==typeof e.quoteChar&&(s=e.quoteChar);"boolean"==typeof e.header&&(r=e.header)}();var a=new RegExp(s,"g");"string"==typeof t&&(t=JSON.parse(t));if(t instanceof Array){if(!t.length||t[0]instanceof Array)return f(null,t);if("object"==typeof t[0])return f(c(t[0]),t)}else if("object"==typeof t)return"string"==typeof t.data&&(t.data=JSON.parse(t.data)),t.data instanceof Array&&(t.fields||(t.fields=t.meta&&t.meta.fields),t.fields||(t.fields=t.data[0]instanceof Array?t.fields:c(t.data[0])),t.data[0]instanceof Array||"object"==typeof t.data[0]||(t.data=[t.data])),f(t.fields||[],t.data||[]);throw"exception: Unable to serialize unrecognized input";function c(t){if("object"!=typeof t)return[];var e=[];for(var n in t)e.push(n);return e}function f(t,e){var n="";"string"==typeof t&&(t=JSON.parse(t)),"string"==typeof e&&(e=JSON.parse(e));var s=t instanceof Array&&t.length>0,a=!(e[0]instanceof Array);if(s&&r){for(var u=0;u<t.length;u++)u>0&&(n+=i),n+=l(t[u],u);e.length>0&&(n+=o)}for(var c=0;c<e.length;c++){for(var f=s?t.length:e[c].length,h=0;h<f;h++){h>0&&(n+=i);var d=s&&a?t[h]:h;n+=l(e[c][d],h)}c<e.length-1&&(n+=o)}return n}function l(t,e){if("undefined"==typeof t||null===t)return"";t=t.toString().replace(a,s+s);var r="boolean"==typeof n&&n||n instanceof Array&&n[e]||function(t,e){for(var n=0;n<e.length;n++)if(t.indexOf(e[n])>-1)return!0;return!1}(t,u.BAD_DELIMITERS)||t.indexOf(i)>-1||" "===t.charAt(0)||" "===t.charAt(t.length-1);return r?s+t+s:t}}};if(u.RECORD_SEP=String.fromCharCode(30),u.UNIT_SEP=String.fromCharCode(31),u.BYTE_ORDER_MARK="\ufeff",u.BAD_DELIMITERS=["\r","\n",'"',u.BYTE_ORDER_MARK],u.WORKERS_SUPPORTED=!r&&!!n.Worker,u.SCRIPT_PATH=null,u.LocalChunkSize=10485760,u.RemoteChunkSize=5242880,u.DefaultDelimiter=",",u.Parser=v,u.ParserHandle=p,u.NetworkStreamer=l,u.FileStreamer=h,u.StringStreamer=d,n.jQuery){var c=n.jQuery;c.fn.parse=function(t){var e=t.config||{},r=[];return this.each(function(t){if(!("INPUT"===c(this).prop("tagName").toUpperCase()&&"file"===c(this).attr("type").toLowerCase()&&n.FileReader)||!this.files||0===this.files.length)return!0;for(var i=0;i<this.files.length;i++)r.push({file:this.files[i],inputElem:this,instanceConfig:c.extend({},e)})}),i(),this;function i(){if(0!==r.length){var e,n,i,s,a=r[0];if(_(t.before)){var f=t.before(a.file,a.inputElem);if("object"==typeof f){if("abort"===f.action)return e="AbortError",n=a.file,i=a.inputElem,s=f.reason,void(_(t.error)&&t.error({name:e},n,i,s));if("skip"===f.action)return void o();"object"==typeof f.config&&(a.instanceConfig=c.extend(a.instanceConfig,f.config))}else if("skip"===f)return void o()}var l=a.instanceConfig.complete;a.instanceConfig.complete=function(t){_(l)&&l(t,a.file,a.inputElem),o()},u.parse(a.file,a.instanceConfig)}else _(t.complete)&&t.complete()}function o(){r.splice(0,1),i()}}}function f(t){this._handle=null,this._paused=!1,this._finished=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var e=b(t);e.chunkSize=parseInt(e.chunkSize),t.step||t.chunk||(e.chunkSize=null);this._handle=new p(e),this._handle.streamer=this,this._config=e}).call(this,t),this.parseChunk=function(t){if(this.isFirstChunk&&_(this._config.beforeFirstChunk)){var e=this._config.beforeFirstChunk(t);void 0!==e&&(t=e)}this.isFirstChunk=!1;var r=this._partialLine+t;this._partialLine="";var o=this._handle.parse(r,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var s=o.meta.cursor;this._finished||(this._partialLine=r.substring(s-this._baseIndex),this._baseIndex=s),o&&o.data&&(this._rowCount+=o.data.length);var a=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(i)n.postMessage({results:o,workerId:u.WORKER_ID,finished:a});else if(_(this._config.chunk)){if(this._config.chunk(o,this._handle),this._paused)return;o=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(o.data),this._completeResults.errors=this._completeResults.errors.concat(o.errors),this._completeResults.meta=o.meta),!a||!_(this._config.complete)||o&&o.meta.aborted||this._config.complete(this._completeResults,this._input),a||o&&o.meta.paused||this._nextChunk(),o}},this._sendError=function(t){_(this._config.error)?this._config.error(t):i&&this._config.error&&n.postMessage({workerId:u.WORKER_ID,error:t,finished:!1})}}function l(t){var e;(t=t||{}).chunkSize||(t.chunkSize=u.RemoteChunkSize),f.call(this,t),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(t){this._input=t,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(e=new XMLHttpRequest,this._config.withCredentials&&(e.withCredentials=this._config.withCredentials),r||(e.onload=w(this._chunkLoaded,this),e.onerror=w(this._chunkError,this)),e.open("GET",this._input,!r),this._config.chunkSize){var t=this._start+this._config.chunkSize-1;e.setRequestHeader("Range","bytes="+this._start+"-"+t),e.setRequestHeader("If-None-Match","webkit-no-cache")}try{e.send()}catch(t){this._chunkError(t.message)}r&&0===e.status?this._chunkError():this._start+=this._config.chunkSize}},this._chunkLoaded=function(){4==e.readyState&&(e.status<200||e.status>=400?this._chunkError():(this._finished=!this._config.chunkSize||this._start>function(t){var e=t.getResponseHeader("Content-Range");if(null===e)return-1;return parseInt(e.substr(e.lastIndexOf("/")+1))}(e),this.parseChunk(e.responseText)))},this._chunkError=function(t){var n=e.statusText||t;this._sendError(n)}}function h(t){var e,n;(t=t||{}).chunkSize||(t.chunkSize=u.LocalChunkSize),f.call(this,t);var r="undefined"!=typeof FileReader;this.stream=function(t){this._input=t,n=t.slice||t.webkitSlice||t.mozSlice,r?((e=new FileReader).onload=w(this._chunkLoaded,this),e.onerror=w(this._chunkError,this)):e=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var t=this._input;if(this._config.chunkSize){var i=Math.min(this._start+this._config.chunkSize,this._input.size);t=n.call(t,this._start,i)}var o=e.readAsText(t,this._config.encoding);r||this._chunkLoaded({target:{result:o}})},this._chunkLoaded=function(t){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(t.target.result)},this._chunkError=function(){this._sendError(e.error)}}function d(t){var e;t=t||{},f.call(this,t),this.stream=function(t){return t,e=t,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var t=this._config.chunkSize,n=t?e.substr(0,t):e;return e=t?e.substr(t):"",this._finished=!e,this.parseChunk(n)}}}function p(t){var e,n,r,i=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,o=this,s=0,a=!1,c=!1,f=[],l={data:[],errors:[],meta:{}};if(_(t.step)){var h=t.step;t.step=function(e){if(l=e,p())d();else{if(d(),0===l.data.length)return;s+=e.data.length,t.preview&&s>t.preview?n.abort():h(l,o)}}}function d(){if(l&&r&&(y("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+u.DefaultDelimiter+"'"),r=!1),t.skipEmptyLines)for(var e=0;e<l.data.length;e++)1===l.data[e].length&&""===l.data[e][0]&&l.data.splice(e--,1);return p()&&function(){if(!l)return;for(var t=0;p()&&t<l.data.length;t++)for(var e=0;e<l.data[t].length;e++)f.push(l.data[t][e]);l.data.splice(0,1)}(),function(){if(!l||!t.header&&!t.dynamicTyping)return l;for(var e=0;e<l.data.length;e++){for(var n=t.header?{}:[],r=0;r<l.data[e].length;r++){var i=r,o=l.data[e][r];t.header&&(i=r>=f.length?"__parsed_extra":f[r]),o=m(i,o),"__parsed_extra"===i?(n[i]=n[i]||[],n[i].push(o)):n[i]=o}l.data[e]=n,t.header&&(r>f.length?y("FieldMismatch","TooManyFields","Too many fields: expected "+f.length+" fields but parsed "+r,e):r<f.length&&y("FieldMismatch","TooFewFields","Too few fields: expected "+f.length+" fields but parsed "+r,e))}t.header&&l.meta&&(l.meta.fields=f);return l}()}function p(){return t.header&&0===f.length}function m(e,n){return!0===(t.dynamicTyping[e]||t.dynamicTyping)?"true"===n||"TRUE"===n||"false"!==n&&"FALSE"!==n&&(r=n,i.test(r)?parseFloat(r):r):n;var r}function y(t,e,n,r){l.errors.push({type:t,code:e,message:n,row:r})}this.parse=function(i,o,s){if(t.newline||(t.newline=function(t){var e=(t=t.substr(0,1048576)).split("\r"),n=t.split("\n"),r=n.length>1&&n[0].length<e[0].length;if(1===e.length||r)return"\n";for(var i=0,o=0;o<e.length;o++)"\n"===e[o][0]&&i++;return i>=e.length/2?"\r\n":"\r"}(i)),r=!1,t.delimiter)"function"==typeof t.delimiter&&(t.delimiter=t.delimiter(i),l.meta.delimiter=t.delimiter);else{var c=function(e,n){for(var r,i,o,s=[",","\t","|",";",u.RECORD_SEP,u.UNIT_SEP],a=0;a<s.length;a++){var c=s[a],f=0,l=0;o=void 0;for(var h=new v({delimiter:c,newline:n,preview:10}).parse(e),d=0;d<h.data.length;d++){var p=h.data[d].length;l+=p,"undefined"!=typeof o?p>1&&(f+=Math.abs(p-o),o=p):o=p}h.data.length>0&&(l/=h.data.length),("undefined"==typeof i||f<i)&&l>1.99&&(i=f,r=c)}return t.delimiter=r,{successful:!!r,bestDelimiter:r}}(i,t.newline);c.successful?t.delimiter=c.bestDelimiter:(r=!0,t.delimiter=u.DefaultDelimiter),l.meta.delimiter=t.delimiter}var f=b(t);return t.preview&&t.header&&f.preview++,e=i,n=new v(f),l=n.parse(e,o,s),d(),a?{meta:{paused:!0}}:l||{meta:{paused:!1}}},this.paused=function(){return a},this.pause=function(){a=!0,n.abort(),e=e.substr(n.getCharIndex())},this.resume=function(){a=!1,o.streamer.parseChunk(e)},this.aborted=function(){return c},this.abort=function(){c=!0,n.abort(),l.meta.aborted=!0,_(t.complete)&&t.complete(l),e=""}}function v(t){var e=(t=t||{}).delimiter,n=t.newline,r=t.comments,i=t.step,o=t.preview,s=t.fastMode,a=t.quoteChar||'"';if(("string"!=typeof e||u.BAD_DELIMITERS.indexOf(e)>-1)&&(e=","),r===e)throw"Comment character same as delimiter";!0===r?r="#":("string"!=typeof r||u.BAD_DELIMITERS.indexOf(r)>-1)&&(r=!1),"\n"!=n&&"\r"!=n&&"\r\n"!=n&&(n="\n");var c=0,f=!1;this.parse=function(t,u,l){if("string"!=typeof t)throw"Input must be a string";var h=t.length,d=e.length,p=n.length,v=r.length,m="function"==typeof i;c=0;var y=[],g=[],b=[],w=0;if(!t)return T();if(s||!1!==s&&-1===t.indexOf(a)){for(var _=t.split(n),k=0;k<_.length;k++){b=_[k];if(c+=b.length,k!==_.length-1)c+=n.length;else if(l)return T();if(!r||b.substr(0,v)!==r){if(m){if(y=[],M(b.split(e)),P(),f)return T()}else M(b.split(e));if(o&&k>=o)return y=y.slice(0,o),T(!0)}}return T()}for(var x=t.indexOf(e,c),j=t.indexOf(n,c),O=new RegExp(a+a,"g");;)if(t[c]!==a)if(r&&0===b.length&&t.substr(c,v)===r){if(-1===j)return T();c=j+p,j=t.indexOf(n,c),x=t.indexOf(e,c)}else if(-1!==x&&(x<j||-1===j))b.push(t.substring(c,x)),c=x+d,x=t.indexOf(e,c);else{if(-1===j)break;if(b.push(t.substring(c,j)),E(j+p),m&&(P(),f))return T();if(o&&y.length>=o)return T(!0)}else{var S=c;for(c++;;){if(-1===(S=t.indexOf(a,S+1)))return l||g.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:y.length,index:c}),I();if(S===h-1)return I(t.substring(c,S).replace(O,a));if(t[S+1]!==a){if(t[S+1]===e){b.push(t.substring(c,S).replace(O,a)),c=S+1+d,x=t.indexOf(e,c),j=t.indexOf(n,c);break}if(t.substr(S+1,p)===n){if(b.push(t.substring(c,S).replace(O,a)),E(S+1+p),x=t.indexOf(e,c),m&&(P(),f))return T();if(o&&y.length>=o)return T(!0);break}}else S++}}return I();function M(t){y.push(t),w=c}function I(e){return l?T():("undefined"==typeof e&&(e=t.substr(c)),b.push(e),c=h,M(b),m&&P(),T())}function E(e){c=e,M(b),b=[],j=t.indexOf(n,c)}function T(t){return{data:y,errors:g,meta:{delimiter:e,linebreak:n,aborted:f,truncated:!!t,cursor:w+(u||0)}}}function P(){i(T()),y=[],g=[]}},this.abort=function(){f=!0},this.getCharIndex=function(){return c}}function m(t){var e=t.data,n=s[e.workerId],r=!1;if(e.error)n.userError(e.error,e.file);else if(e.results&&e.results.data){var i={abort:function(){r=!0,y(e.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:g,resume:g};if(_(n.userStep)){for(var o=0;o<e.results.data.length&&(n.userStep({data:[e.results.data[o]],errors:e.results.errors,meta:e.results.meta},i),!r);o++);delete e.results}else _(n.userChunk)&&(n.userChunk(e.results,i,e.file),delete e.results)}e.finished&&!r&&y(e.workerId,e.results)}function y(t,e){var n=s[t];_(n.userComplete)&&n.userComplete(e),n.terminate(),delete s[t]}function g(){throw"Not implemented."}function b(t){if("object"!=typeof t)return t;var e=t instanceof Array?[]:{};for(var n in t)e[n]=b(t[n]);return e}function w(t,e){return function(){t.apply(e,arguments)}}function _(t){return"function"==typeof t}return i?n.onmessage=function(t){var e=t.data;"undefined"==typeof u.WORKER_ID&&e&&(u.WORKER_ID=e.workerId);if("string"==typeof e.input)n.postMessage({workerId:u.WORKER_ID,results:u.parse(e.input,e.config),finished:!0});else if(n.File&&e.input instanceof File||e.input instanceof Object){var r=u.parse(e.input,e.config);r&&n.postMessage({workerId:u.WORKER_ID,results:r,finished:!0})}}:u.WORKERS_SUPPORTED&&(e=document.getElementsByTagName("script"),t=e.length?e[e.length-1].src:"",document.body?document.addEventListener("DOMContentLoaded",function(){o=!0},!0):o=!0),l.prototype=Object.create(f.prototype),l.prototype.constructor=l,h.prototype=Object.create(f.prototype),h.prototype.constructor=h,d.prototype=Object.create(d.prototype),d.prototype.constructor=d,u})?r.apply(e,i):r)||(t.exports=o)},ETHv:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("/Hyb"),i=n("YaPU"),o=n("kZql"),s=n("IJ8i"),a=n("9zHd"),u=n("uXZL"),c=n("t4zo"),f=function(){function t(){}return t.dn=function(t){return a.unparse(t,{quotes:!1,delimiter:"\t",newline:"\r\n"})},t.nl=function(t,e){var n={SheetNames:["SheetJS"],Sheets:{}};n.Sheets.SheetJS=u.utils.aoa_to_sheet(t),e=e.replace(/[^\w]/g,"_")+".xlsx",u.writeFile(n,e)},t.ll=function(t,e){var n=a.unparse(t);e=e.replace(/[^\w]/g,"_")+".csv";var r=new File([n],"test.csv",{type:"text/csv;charset=utf-8"});c.saveAs(r,e)},t.ul=function(t){return/[^\u0000-\u00ff]/.test(t)},t.tl=function(t){var e=document.createElement("a");return e.href=t,{domain:e.host,pathname:e.pathname,url:t,protocol:e.protocol}},t.Rn=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},t.el=function(t){var e=new Uint32Array(2);crypto.getRandomValues(e);for(var n="",r=0;r<e.length;++r)n+=e[r].toString(36);return n.substring(0,t)},t.il=function(t){for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz12345678901234567890123456789012345678901234567890",r=0;r<t;r++)e+=n.charAt(Math.floor(Math.random()*n.length));return e},t.tn=function(t,e){return e.restricted&&e.restricted.indexOf("Free plan")>-1&&"popup"!==t?{error:{title:"",body:"<a href='https://data-miner.io/account' target='_blank'><img src='assets/img/limit-free-upgrade@2x.png'></a>",alertType:"alert-default"}}:e.restricted&&e.restricted.indexOf("have exceeded")>-1&&"popup"!==t?{error:{title:"",body:"<a href='https://data-miner.io/account' target='_blank'><img src='assets/img/limit-upgrade@2x.png'></a>",alertType:"alert-default"}}:e.restricted&&e.restricted.indexOf("is restricted")>-1&&"popup"!==t?{error:{title:"",body:"<a href='https://data-miner.io/account' target='_blank'><img src='assets/img/limit-some-domains@2x.png'></a>",alertType:"alert-default"}}:void 0},t.ln=function(t,e,n,i){var s="login_test?uid="+e+"&c="+n+"&url="+encodeURIComponent(i).slice(0,1e3);return t.get(o.environment.apiEndPoint+s).map(function(t){var i,a;try{i=t.json()}catch(i){throw t.url!==o.environment.apiEndPoint+s?r.captureMessage("proxy-redirect-error",{level:"info",extra:{uid:e,version:n,url:t.url,response:t.text(),error:i}}):i.message.startsWith("Unexpected token")?r.captureMessage("proxy-parse-error",{level:"info",extra:{uid:e,version:n,url:t.url,response:t.text(),error:i}}):i.message.startsWith("SyntaxError")?(r.captureBreadcrumb({message:"parse_error",category:"login_test",data:{uid:e,version:n,url:t.url,response:t.text(),error:i}}),r.captureMessage("login-error",{level:"info",extra:{url:t.url,response:t.text()}})):(r.captureBreadcrumb({message:"other_login_error",category:"login_test",data:{uid:e,version:n,url:t.url,response:t.text(),error:i}}),r.captureException(i)),new Error(i)}if("NEEDAUTH"===i.error)throw new Error("login-needed");return a={user:{user_id:i.user_id,email:i.user_name,jwe:i.jwe},serverData:i},r.setUserContext({id:i.user_id,email:i.user_name}),a.pins=i.pins,a}).retryWhen(function(t){return t.scan(function(t,e){if("login-needed"===e.message||"redirect-error"===e.message)throw new Error("login-needed");if(r.captureBreadcrumb({message:"network_error",category:"login_test",data:{url:s,error:e}}),t>=2)throw new Error("login-network-error");return t+1},0).delay(3e3)})},t.rl=function(t,e){var n,r=String.fromCharCode.apply(String,[32,91,85,112,103,114,97,100,101,32,116,111,32,115,101,101,32,105,110,32,102,117,108,108,93]);if(t&&"segment"in t&&(n=t.segment),n&&"restricted"in n)for(var o=0;o<e.rows.length;o++)for(var s=0;s<e.rows[o].length;s++)e.rows[o][s].length>50/7&&(e.rows[o][s]=e.rows[o][s].substring(0,50/7)+r);return i.Observable.of({results:e,restriction:void 0})},t.Ln=function(t){var e={comment:"",domain:"xxx",regex_page:"",name:"xxx",example_url:"",url:"xxx",description_url:"",recipe_icon_url:"",regex_url:"",regex_domain:"xxx",data:{schema:"1.1",recipe_type:"xxx",next_page:"",next_page_type:"click",next_page_time:2,language:"xxx",selector:"xxx",attributes:[]}};t.actionsPre&&t.actionsPre.length>0&&(e.data.actionsPre=t.actionsPre),e.name=(t.recipeName||"").trim(),e.comment=(t.comment||"").trim(),e.data.recipe_type="detail"===t.recipeType?"detail":"list",e.domain=t.domain.domainName,e.url=t.domain.url,e.regex_domain=t.domain.regex,e.data.language=t.language===s.Language.jquery?"jquery":"xpath",""!==t.next.query&&(e.data.next_page=t.next.query,e.data.next_page_time=2),e.data.selector=t.row.query;for(var n=0,r=t.cols;n<r.length;n++){var i=r[n],o={name:i.name,method:i.method};t.language===s.Language.jquery?o.query=i.query:o.xpath=i.query,i.attribute&&(i.attribute||"").trim()&&(o.attribute=i.attribute),e.data.attributes.push(o)}return e.recipe_id=t.recipeId,e.parent_recipe_id=t.parentRecipeId,t.scripts&&t.scripts.length>0&&(e.data.script=t.scripts[0].script.trim(),e.data.script_type=t.scripts[0].scriptType,e.data.script_schema=t.scripts[0].schema),e},t.ol=function(e){var n={};n.schema=s.En,n.id=e.id,n.recipeId=e.recipe_id,n.row={id:t.Rn(),name:"Row Selector",query:e.data.selector},n.next={id:t.Rn(),name:"Next Page",query:e.data.next_page},n.cols=[];for(var r=0,i=e.data.attributes;r<i.length;r++){var o=i[r],a=void 0,u=void 0,c=void 0,f=void 0;"xpath"===e.data.language?(a=o.xpath,n.language=s.Language.xpath):"jquery"===e.data.language&&(a=o.query,n.language=s.Language.jquery,void 0===o.attribute&&""===o.attribute||(c=o.attribute)),u="text"===o.method?0:"text_direct"===o.method?1:"html"===o.method?2:"url"===o.method?3:"src"===o.method?4:"attribute"===o.method?5:void 0===o.method?0:o.method,f={id:t.Rn(),name:o.name,query:a,method:u},void 0!==c&&(f.attribute=c),n.cols.push(f)}return void 0!==e.data.recipe_type&&""!==e.data.recipe_type.trim()||(e.data.recipe_type="list"),n.recipeType=e.data.recipe_type,n.domain={domainName:(e.domain||"").trim(),regex:e.regex_domain||(e.domain||"").trim(),url:(e.url||"").trim()},n.recipeName=(e.name||"").trim(),n.comment=(e.comment||"").trim(),n.recipeId=e.recipe_id,e.data.script_type&&e.data.script&&""!==e.data.script.trim()?n.scripts=[{script:e.data.script.trim(),scriptType:e.data.script_type,schema:e.data.script_schema||"1.0"}]:n.scripts=[{script:"",scriptType:"none",schema:"1.0"}],void 0!==e.data.actionsPre?n.actionsPre=e.data.actionsPre:n.actionsPre=[],n},t.al=function(){var t;r.captureBreadcrumb({message:"document_info",category:"iframe",data:{referrer:document.referrer,document_location:document.location}});var e="";try{"object"!=typeof chrome?e="resources-needed-chrome":"object"!=typeof chrome.runtime?e="resources-needed-chrome.runtime":"object"!=typeof chrome.tabs&&(e="resources-needed-chrome.tabs")}catch(t){r.captureException(t),e=t.message}return!!e&&(r.captureBreadcrumb({message:"load_error",category:"iframe",data:{error:e}}),e.startsWith("Failed to read the 'localStorage' property from 'Window'")?(t='     <strong>Cause:</strong> Your Chrome settings don\'t allow third party cookies. To make a recipe this extension\n                                needs to save temporary data in your cookies.<br><br>\n                                <strong>Solution:</strong> To solve this problem please follow the steps below:<br><br>\n                                1) Copy & Paste this URL in address bar: <br>\n                                <strong>chrome://settings/content/cookies</strong><br><br>\n                                2) Turn off (make it gray) "Block third-party cookies"\n                                <br><br><br>\n                                For detail step by step instructions to enable cookies visit:<br>\n                                <a href="https://data-miner.io/allow-cookies" target="_blank">https://data-miner.io/allow-cookies</a>.\n                                <br>You can contact us via <a href="mailto:support@data-miner.io" target="_blank">support@data-miner.io</a>\n                                if you need further assistance. <br>\n                                ',r.captureMessage("rc-load-missing-localstorage",{level:"info",extra:{error:e}})):e.startsWith("resources-needed")?(t='     Unfortunately Data Miner has encountered a problem.\n                                <br><br>\n                                If your chrome version is less than <strong>version 61</strong> you should upgrade it to be able to use Data Miner.\n                                Upgrade your browser from <a href="https://www.google.com/chrome" target="_blank">https://www.google.com/chrome</a>\n                                <br><br>If you have Chrome 61+ and this error keeps happening on your machine <strong>We will reward you a\n                                1000 scraping credits if you show our developers this error so they can investigate why it happens.\n                                Please contact us via <a href="mailto:support@data-miner.io" target="_blank">support@data-miner.io</a>\n                                </strong><br><br>\n                                <strong>Error:</strong> '+e,r.captureMessage("rc-load-resources-needed",{level:"info",extra:{error:e}})):t='     Unfortunately Data Miner has encountered a problem. Please reload this page.\n                                <br><br>\n                                If your chrome version is less than <strong>version 61</strong> you should upgrade it to be able to use Data Miner.\n                                Upgrade your browser from <a href="https://www.google.com/chrome" target="_blank">https://www.google.com/chrome</a>\n                                <br><br>If the problem persists please contact us via <a href="mailto:support@data-miner.io" target="_blank">\n                                support@data-miner.io</a> so we can further assist you. <br><br>\n                                <strong>Error:</strong> '+e,{error:e,resolution:"error-message",message:t})},t}();e.DmUtility=f},HFz5:function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n("/Hyb"),s=n("YaPU"),a=n("lMIw"),u=n("kZql"),c=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r._socket=n.socket,r}return i(e,t),e.prototype.c=function(t){var e=this;return this.payload.serverUrl===u.environment.apiVoteEndPoint?s.Observable.ajax.post(this.payload.serverUrl,this.payload.content,{"Content-Type":"application/json"}).map(function(t){var n;try{n=t.response}catch(n){throw o.captureBreadcrumb({message:"parse_error",category:"send_vote",data:{response:t.response,url:e.payload.serverUrl,error:n}}),o.captureException(n),n}return s.Observable.of(n)}).catch(function(t){return s.Observable.of({})}):(this._socket.h(this.payload.content),s.Observable.of({}))},e}(a.CommandBase);e.CommandVote=c},IJ8i:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.xpath=0]="xpath",t[t.jquery=1]="jquery"}(e.Language||(e.Language={})),function(t){t[t.text=0]="text",t[t.text_direct=1]="text_direct",t[t.html=2]="html",t[t.url=3]="url",t[t.src=4]="src",t[t.attribute=5]="attribute"}(e.Method||(e.Method={})),function(t){t[t.scrape=0]="scrape",t[t.clearSelection=1]="clearSelection",t[t.ping=2]="ping",t[t.insertIframe=3]="insertIframe",t[t.getElement=4]="getElement",t[t.goUpParent=5]="goUpParent",t[t.toggleIframe=6]="toggleIframe",t[t.removeIframe=7]="removeIframe",t[t.highlightQuery=8]="highlightQuery",t[t.navigateNextPage=9]="navigateNextPage",t[t.getPageInfo=10]="getPageInfo",t[t.enableHighlighter=11]="enableHighlighter",t[t.disableHighlighter=12]="disableHighlighter",t[t.tryRecipe=13]="tryRecipe",t[t.scrapeNextPage=14]="scrapeNextPage",t[t.moveIframe=15]="moveIframe",t[t.runPostScript=16]="runPostScript",t[t.sendVote=17]="sendVote",t[t.createRecipe=18]="createRecipe",t[t.runPreScript=19]="runPreScript",t[t.highlightedElementInfo=20]="highlightedElementInfo",t[t.reOpenIframe=21]="reOpenIframe",t[t.runAction=22]="runAction",t[t.getBGSettings=23]="getBGSettings",t[t.setBGSettings=24]="setBGSettings",t[t.removeBGSettings=25]="removeBGSettings",t[t.setBGUser=26]="setBGUser"}(e.Command||(e.Command={})),function(t){t[t.preClick=0]="preClick",t[t.preScroll=1]="preScroll",t[t.preInfiniteScrollClick=2]="preInfiniteScrollClick",t[t.postClick=3]="postClick"}(e.Action||(e.Action={})),e.En=8},QCxu:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.styles=[""]},RXfN:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BgStateInitialState={user:null,counters:null,serverData:null,extension:null,pins:null}},Tkuz:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("rKkt"),i=n("3j3K");e.rootReducer={bgState:r.default},e.REDUCERS_TOKEN=new i.InjectionToken("Registered Reducers"),e.REDUCER_PROVIDER=[{provide:e.REDUCERS_TOKEN,useValue:e.rootReducer}]},UWBK:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("3j3K"),i=n("dyjq"),o=function(){function t(t,e){this._appRef=t,this.store=e}return t.prototype._setInitial=function(e){this.store.dispatch({type:t.SET_INITIAL,payload:e})},t.prototype._setCheckDate=function(e){this.store.dispatch({type:t.SET_CHECK_DATE,payload:e})},t.prototype._setUID=function(e){this.store.dispatch({type:t.SET_UID,payload:e})},t.prototype._setUser=function(e){this.store.dispatch({type:t.SET_USER,payload:e})},t.prototype._setCounters=function(e){this.store.dispatch({type:t.SET_COUNTERS,payload:e})},t.ctorParameters=function(){return[{type:r.ApplicationRef},{type:i.Store}]},t.SET_INITIAL="SET_INITIAL",t.SET_UID="SET_UID",t.SET_CHECK_DATE="SET_CHECK_DATE",t.SET_USER="SET_USER",t.SET_COUNTERS="SET_COUNTERS",t.NO_ACTION="NO_ACTION",t}();e.BgStateActions=o},YO03:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("QCxu"),i=n("3j3K"),o=n("YtC4"),s=n("dyjq"),a=n("Fzro"),u=n("/PSk"),c=n("jPRv"),f=n("nfmY"),l=n("UWBK"),h=[r.styles];function d(t){return i.\u0275vid(0,[],null,null)}function p(t){return i.\u0275vid(0,[(t()(),i.\u0275eld(0,0,null,null,1,"app-root",[],null,null,null,d,e.RenderType_AppComponent)),i.\u0275did(1,49152,null,0,o.AppComponent,[s.Store,a.Http,u.CommandsRouter,c.ListenerService,f.BgStateService,l.BgStateActions],null,null)],null,null)}e.RenderType_AppComponent=i.\u0275crt({encapsulation:0,styles:h,data:{}}),e.View_AppComponent_0=d,e.View_AppComponent_Host_0=p,e.AppComponentNgFactory=i.\u0275ccf("app-root",o.AppComponent,p,{},{},[])},YtC4:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("dyjq"),i=n("UWBK"),o=n("nfmY"),s=n("jPRv"),a=n("Fzro"),u=n("/PSk"),c=n("ETHv"),f=function(){function t(t,e,n,r,i,o){var s=this;this._store=t,this._http=e,this._commandsRouter=n,this._listenerService=r,this._bgStateService=i,this._bgStateActions=o,ga("send","pageview","background"),this._bgState$=this._store.select(function(t){return t.bgState}).share(),this._bgState$.debounceTime(1e4).filter(function(t){return null!==t.user&&void 0!==t.user.uid}).take(1).switchMap(function(t){return c.DmUtility.ln(s._http,t.user.uid,t.extension.version,"background")}).subscribe(function(t){s._bgStateActions._setInitial(t)},function(t){"xxx"===t&&alert(t)})}return t.ctorParameters=function(){return[{type:r.Store},{type:a.Http},{type:u.CommandsRouter},{type:s.ListenerService},{type:o.BgStateService},{type:i.BgStateActions}]},t}();e.AppComponent=f},Zhbi:function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var o=n("8AXl"),s=n("dyjq"),a=n("YaPU"),u=n("UWBK"),c=n("nfmY"),f=function(){function t(t,e,n){var r=this;this._store=t,this._bgStateService=e,this._actions$=n,this._logUser$=this._actions$.ofType(u.BgStateActions.SET_INITIAL,u.BgStateActions.SET_CHECK_DATE,u.BgStateActions.SET_USER,u.BgStateActions.SET_COUNTERS).withLatestFrom(this._store.select(function(t){return t.bgState})).filter(function(t){t[0];return null!==t[1].user}).switchMap(function(t){t[0];var e=t[1];return r._bgStateService._saveUserState(e),a.Observable.of({type:u.BgStateActions.NO_ACTION})})}return t.ctorParameters=function(){return[{type:s.Store},{type:c.BgStateService},{type:o.Actions}]},r([o.Effect(),i("design:type","function"==typeof(e="undefined"!=typeof a.Observable&&a.Observable)&&e||Object)],t.prototype,"_logUser$",void 0),t;var e}();e.BgStateEffects=f},"c/bU":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("3j3K"),i=n("YaPU"),o=n("IJ8i"),s=n("/Hyb"),a=n("8eev"),u=n("ETHv"),c=function(){function t(t){this._zone=t}return t.prototype.hl=function(e){var n=this;return this._connectedTab=e.id,new i.Observable(function(e){var r=function(t,r){n._connectedTab===r.sender.tab.id&&e.next({readyState:t.readyState})};chrome.runtime.onConnect.addListener(function(e){e.name===t._CS_CHANNEL&&(n._portCS=e,n._portCS.onMessage.addListener(r))})})},t.prototype.gl=function(t,e,n){"manual"===n&&(e.meta=e.meta||{},e.meta.nextWaitTime=1);for(var r={command:o.Command.scrape,payload:{url:t.url,recipe:e,mode:n,collection_id:""}},s=[],a=0,u=e.cols;a<u.length;a++){var c=u[a];s.push(c.name)}return new i.Observable(function(e){chrome.tabs.sendMessage(t.id,r,{},function(n){n?e.next({rows:n.result.rows,heads:s,tab:t,url:t.url,htmlSource:n.result.htmlSource}):console.log("no response")})})},t.prototype.vl=function(t,e,n){var r={command:o.Command.runPostScript,payload:{script:e,context:n}};return new i.Observable(function(e){chrome.tabs.sendMessage(t.id,r,{},function(t){e.next(t.result)})})},t.prototype.bl=function(t,e,n){var r={command:o.Command.runPreScript,payload:{script:e,context:n}};return new i.Observable(function(e){chrome.tabs.sendMessage(t.id,r,{},function(t){e.next(null)})})},t.prototype.ml=function(t,e,n){var r={command:o.Command.runAction,payload:{action:e,context:n}};return new i.Observable(function(e){chrome.tabs.sendMessage(t.id,r,{},function(t){e.next({}),e.complete()})})},t.prototype.yl=function(t,e){var n={command:o.Command.tryRecipe,payload:{tab:e.id,url:e.url,communityRecipes:t.communityRecipes,userRecipes:t.userRecipes,mode:"try"}};return new i.Observable(function(r){t.error&&"NEEDAUTH"===t.error&&r.error(new Error("need-auth")),chrome.tabs.sendMessage(e.id,n,{},function(t){t.result.communityRecipes=t.result.communityRecipes.sort(function(t,e){return e.containerQuality-t.containerQuality||e.quality-t.quality}),r.next({result:t.result,tab:e})})})},t.prototype.fl=function(t,e){var n={command:o.Command.navigateNextPage,payload:{recipe:e}};return new i.Observable(function(e){chrome.tabs.sendMessage(t.id,n,{},function(n){e.next({result:"success",tabId:t.id})})})},t.prototype.Bn=function(){var t=new a.AsyncSubject;return chrome.tabs.query({active:!0,windowType:"normal",currentWindow:!0},function(e){var n=e[0];s.captureBreadcrumb({message:"get_tab",category:"dmc",data:{tab:n}});var r=n.url;if(void 0==r||""===r||""===r.trim())t.error(new Error("blocked-domains"));else if(0===r.indexOf("chrome-extension")||0===r.indexOf("chrome://")||0===r.indexOf("file://"))t.error(new Error("blocked-domains"));else if(0===r.indexOf("https://chrome.google.com/webstore"))t.error(new Error("chrome-store"));else{var i=chrome.extension.getBackgroundPage();i.DMState.lastUrlInfo=u.DmUtility.tl(r),t.next({id:n.id,url:n.url,url_info:i.DMState.lastUrlInfo}),t.complete()}}),t.asObservable()},t.prototype.Wn=function(t){var e={command:o.Command.ping,payload:{tab_id:t.id}};return new i.Observable(function(n){chrome.tabs.sendMessage(t.id,e,{},function(t){!t||t.error||"I am here"!==t.result?n.error(new Error("tab-closed")):n.next("I am here")})})},t.prototype.mn=function(t,e){var n={command:o.Command.insertIframe,payload:{chrome_id:e}};return new i.Observable(function(e){chrome.tabs.sendMessage(t.id,n,{},function(n){e.next(t)})})},t.prototype.cl=function(t,e,n,r){var s={command:o.Command.getElement,payload:{tab:t.id,selector:e,language:r,method:n}};return new i.Observable(function(e){chrome.tabs.sendMessage(t.id,s,{},function(t){e.next(t.result)})})},t.ctorParameters=function(){return[{type:r.NgZone}]},t._CS_CHANNEL="cs",t}();e.ContentCommService=c},ehMW:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("HFz5"),i=n("IJ8i"),o=function(){function t(){this.f={}}return t.prototype.u=function(t,e,n){switch(+t){case i.Command.sendVote:return this.f[i.Command.sendVote]?this.f[i.Command.sendVote].init(e,n):this.f[i.Command.sendVote]=new r.CommandVote(e,n),this.f[i.Command.sendVote];default:return null}},t}();e.CommandFactoryBg=o},iu7K:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("/Hyb");n("/L6G");var i=n("kZql");ga("create",i.environment.analyticsID,"auto"),ga("set","checkProtocolTask",function(){}),ga("send","event","version",chrome.runtime.getManifest().version);var o=function(){function t(){}return t.prototype.handleError=function(t){console.log(t),r.captureException(t)},t}();e.RavenErrorHandler=o,i.environment.errorReporting?r.config(i.environment.sentry,{environment:!0===i.environment.production?"production":"dev",release:chrome.runtime.getManifest().version}).install():console.log("==== NOT Reporting Errors ====");var s=function(){return function(){}}();e.BgModule=s},jPRv:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("dyjq"),i=n("kZql"),o=n("g5jc"),s=n("UWBK"),a=n("IJ8i"),u=n("ETHv"),c=n("9C4N"),f=function(){function t(t,e){var n=this;this._store=t,this._bgStateActions=e,this._extensionInstallNotification$=new o.Subject,this._appVersion=chrome.runtime.getManifest().version,this._setupUpdateListener(this._extensionInstallNotification$),"dm"===c.DM_GLOBAL.extension_type.split("-")[0]&&this._setupRightClickButton(),this._bgState$=this._store.select(function(t){return t.bgState}).shareReplay(),this._bgState$.filter(function(t){return null!==t.user&&void 0!==t.user.uid}).take(1).subscribe(function(t){n._setupUninstall(t),n._bgState=t}),this._extensionInstallNotification$.withLatestFrom(this._bgState$.filter(function(t){return null!==t.user&&void 0!==t.user.uid})).subscribe(function(t){var e=t[0],n=t[1];if("installed"===e.type)chrome.tabs.create({url:i.environment.serverURL+"u/"+n.user.uid+"/new/welcome"});else if("updated"===e.type){var r=chrome.runtime.getManifest().version.split("."),o=e.details.previousVersion.split(".");parseInt(r[0],10)>4&&parseInt(r[0],10)>parseInt(o[0],10)&&chrome.tabs.create({url:i.environment.serverURL+"u/"+n.user.uid+"/update/welcome"})}})}return t.prototype._setupUninstall=function(t){var e=t.user.uid,n=(new Date).setHours(0,0,0,0);t.extension.check_date!==n&&(this._bgStateActions._setCheckDate(n),chrome.runtime.requestUpdateCheck(function(t){"update_available"===t?console.log("https://data-miner.io: update pending..."):"no_update"===t||"throttled"===t&&console.log("https://data-miner.io: Oops, I'm asking too frequently - I need to back off.")})),"dm"===c.DM_GLOBAL.extension_type.split("-")[0]?chrome.runtime.setUninstallURL(i.environment.serverURL+"u/"+e+"/uninstall/thanks"):"rc"===c.DM_GLOBAL.extension_type.split("-")[0]&&chrome.runtime.setUninstallURL(i.environment.serverURL+"u/"+e+"/uninstall/rc-thanks")},t.prototype._setupUpdateListener=function(t){chrome.runtime.onInstalled.addListener(function(e){"update"===e.reason?t.next({type:"updated",details:e}):t.next({type:"installed",details:e})}),chrome.runtime.onUpdateAvailable.addListener(function(t){console.log("updating to version "+t.version),chrome.runtime.reload()})},t.prototype._setupRightClickButton=function(){chrome.contextMenus.removeAll(function(){chrome.contextMenus.create({title:"Get Similar (Data Miner)",contexts:["all"],onclick:function(t,e){var n={command:a.Command.createRecipe,payload:{}};chrome.tabs.sendMessage(e.id,n,{},function(t){if(t&&t.result){var n,r=t.result;r.recipe?(n=u.DmUtility.ol({schema:a.En,id:0,recipeId:"",name:"Auto-generated Recipe ("+u.DmUtility.il(5)+")",domain:r.pageInfo.domain,url:r.pageInfo.url,data:{selector:r.recipe.selector,attributes:r.recipe.attributes,language:r.recipe.language,next_page:""}}),localStorage[c.DM_GLOBAL.extensio_id+"viewer.stringify_recipe"]=JSON.stringify(n)):localStorage[c.DM_GLOBAL.extensio_id+"viewer.stringify_recipe"]="{}",localStorage[c.DM_GLOBAL.extensio_id+"viewer.stringify_tab"]=JSON.stringify(e),chrome.windows.create({url:chrome.extension.getURL("client/dist/index.html#/viewer"),type:"popup",width:Math.max(1200,parseInt(localStorage[c.DM_GLOBAL.extensio_id+"viewer.width"]||.8*screen.width,10)),left:400,top:400,height:Math.max(600,parseInt(localStorage[c.DM_GLOBAL.extensio_id+"viewer.height"]||.8*screen.height,10))})}else chrome.tabs.executeScript(e.id,{code:'alert("Initializing Data Miner... Please reload this web page and re-open Data Miner.");'})})}})})},t.ctorParameters=function(){return[{type:r.Store},{type:s.BgStateActions}]},t}();e.ListenerService=f},kZql:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.environment={errorReporting:!0,production:!0,mock:!1,apiEndPoint:"https://data-miner.io/v3/",apiRecipeQualityEndPoint:"wss://api.dataminer.io/connect/v1.2/",apiVoteEndPoint:"https://api.data-miner.io/v1.5/vote/",serverURL:"https://data-miner.io/",sentry:"https://4c239843559f492a88bedc8a536a2393@sentry.io/1201985",analyticsID:"UA-12630940-7"}},kk9o:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("3j3K"),i=n("kZql"),o=n("+LL8"),s=n("Qbdm");i.environment.production&&r.enableProdMode(),s.platformBrowser().bootstrapModuleFactory(o.BgModuleNgFactory)},lMIw:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){this._payload=t,this._context=e}return Object.defineProperty(t.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"payload",{get:function(){return this._payload},enumerable:!0,configurable:!0}),t.prototype.init=function(t,e){this._payload=t,this._context=e},t}();e.CommandBase=r},nfmY:function(t,e,n){"use strict";var r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};Object.defineProperty(e,"__esModule",{value:!0});var i=n("dyjq"),o=n("UWBK"),s=n("YaPU"),a=n("ETHv"),u=n("Fzro"),c=function(){function t(t,e,n){var r=this;this._store=t,this._http=e,this._bgStateActions=n,this._load().subscribe(function(t){r._bgStateActions._setInitial(t)})}return t.prototype._saveUserState=function(t){var e={},n=chrome.extension.getBackgroundPage().dmBackground;n.user=n.user||{},n.counters=n.counters||{},t.user&&t.user.email&&(e=r({},e,{email:t.user.email}),n.user.user_id=t.user.user_id),t.user&&t.user.user_id&&(e=r({},e,{user_id:t.user.user_id}),n.user.user_id=t.user.user_id),t.user&&t.user.uid&&(e=r({},e,{uid:t.user.uid})),t.sleep&&(e=r({},e,{sleep:t.sleep})),t.extension&&t.extension.check_date&&(e=r({},e,{check_date:t.extension.check_date})),t.extension&&t.extension.install_date&&(e=r({},e,{install_date:t.extension.install_date})),t.counters&&t.counters.today&&(e=r({},e,{today:t.counters.today}),n.counters.today=t.counters.today),t.counters&&t.counters.today_count&&(e=r({},e,{today_count:t.counters.today_count}),n.counters.today_count=t.counters.today_count),t.counters&&t.counters.total_count&&(e=r({},e,{total_count:t.counters.total_count}),n.counters.total_count=t.counters.total_count),t.counters&&t.counters.token&&(e=r({},e,{token:t.counters.token}),n.counters.token=t.counters.token),chrome.storage.sync.set(e),void 0!==t.serverData&&(n.serverData=t.serverData)},t.prototype._load=function(){return new s.Observable(function(e){var n=chrome.runtime.getManifest().version;chrome.storage.sync.get(t.LOCAL_STORE_KEY_LIST,function(t){var r={user:{},counters:{},extension:{}},i=(new Date).setHours(0,0,0,0);void 0===t.uid&&(t.uid=a.DmUtility.el(10),t.install_date=i),r.user={uid:t.uid,user_id:t.user_id,email:t.email},r.counters={today_count:parseInt(t.today_count||"0",10),total_count:parseInt(t.total_count||"0",10),token:t.token||"",today:i},r.extension={version:n,sleep:t.sleep,install_date:t.install_date,check_date:t.check_date},e.next(r)})})},t.ctorParameters=function(){return[{type:i.Store},{type:u.Http},{type:o.BgStateActions}]},t.LOCAL_STORE_KEY_LIST=["uid","email","user_id","today","server","sleep","refresh","today_count","total_count","token","install_date","check_date"],t}();e.BgStateService=c},rKkt:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("RXfN"),i=n("UWBK"),o=n("M4fF");e.default=function(t,e){switch(void 0===t&&(t=r.BgStateInitialState),e.type){case i.BgStateActions.SET_INITIAL:return o.merge({},t,e.payload);case i.BgStateActions.SET_CHECK_DATE:return o.merge({},t,{extension:{check_date:e.payload}});case i.BgStateActions.SET_USER:return o.merge({},t,{user:e.payload});case i.BgStateActions.SET_COUNTERS:return o.merge({},t,{counters:e.payload});default:return t}}},y3P1:function(t,e,n){"use strict";var r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};Object.defineProperty(e,"__esModule",{value:!0});var i=n("kZql"),o=n("/Hyb"),s=n("dyjq"),a=function(){function t(t){var e=this;this._store=t,this._WATCHDOG_TIMER=3e5,this._backLog=[],this._session=null,this._socket=null,this._connectionAttempts=0,this._connectionSendAttempts=0,this._connectionErrors=[],this._connectionClose=[],this._bgState$=this._store.select(function(t){return t.bgState}).filter(function(t){return null!==t}),this._bg={},this._bgState$._subscribe(function(t){e._bg=t})}return t.prototype.h=function(t){if(t&&this._backLog.push(t),!(this._backLog.length<1))if(this._socket&&this._socket.readyState===WebSocket.OPEN){try{if(this._connectionSendAttempts++,this._connectionSendAttempts>10)return o.captureMessage("socket-network-send-stuck",{level:"warning",extra:{bg:JSON.stringify(this._bg)}}),this._backLog=[],void(this._socket&&this._socket.readyState===WebSocket.OPEN&&this._socket.close());this._connectionClose.length>20&&(this._connectionClose=this._connectionClose.slice(20)),this._connectionErrors.length>20&&(this._connectionErrors=this._connectionErrors.slice(20));var e=JSON.stringify({type:"dm-event",data:{payload:this._backLog,user:r({schema:"1.1"},this._bg.user),connection:{connection_attempts:this._connectionAttempts,send_attempts:this._connectionSendAttempts,close:this._connectionClose,errors:this._connectionErrors}}});this._socket.send(e),this._connectionSendAttempts=0,this._connectionAttempts=0}catch(t){this._socket=null,o.captureMessage("socket-network-send-error",{level:"info",extra:{bg:this._bg,event:e}})}this._backLog=[]}else(null===this._socket||this._socket&&this._socket.readyState===WebSocket.CLOSED)&&this.rt()},t.prototype.rt=function(){var t=this;if(this._connectionAttempts>10)o.captureMessage("socket-network-connect-stuck",{level:"warning",extra:{bg:JSON.stringify(this._bg)}});else try{this._connectionAttempts++,this._socket=new WebSocket(i.environment.apiRecipeQualityEndPoint+"socket"),this._socket.onopen=function(){t.h(null)},this._socket.onclose=function(e){t._connectionClose.push(e.code),e.code,t._socket=null},this._socket.onerror=function(e){t._connectionErrors.push(e.type),1!==t._socket.readyState&&o.captureMessage("socket-network-connect-error1",{level:"info",extra:{bg:t._bg,event:e}})},this._socket.onmessage=function(t){}}catch(t){this._socket=null,o.captureMessage("socket-network-connect-error2",{level:"info",extra:{bg:this._bg}})}},t.ctorParameters=function(){return[{type:s.Store}]},t}();e.WebsocketService=a}},[1]);
//# sourceMappingURL=main.3f4226ab7b511fbab0ac.bundle.js.map